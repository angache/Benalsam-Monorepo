import{j as e}from"./query-tMv1bFhv.js";import{d as N,u as S,r as s}from"./router-Bq68dJ36.js";import{d as L,g as w,B as u,s as D}from"./auth-Dm-7ngQy.js";import{aM as g,S as T,F as B,G as A,H as z,J as C,aN as R,aO as E}from"./listings-CDgdt6vp.js";import{m as F,a as G,p as I,aN as f}from"./ui-YP8xOIYG.js";import"./vendor-Bs7gn1Hv.js";import"./images-C3EucWOq.js";import"./supabase-D6FkHI3a.js";const P=["Yasaklı ürün veya hizmet","Yanlış veya yanıltıcı kategori","Aldatıcı veya eksik bilgi","Spam veya alakasız içerik","Telif hakkı ihlali","Dolandırıcılık şüphesi","BenAlsam politikalarına aykırı","Diğer"],U=()=>{const{listingId:i}=N(),r=S(),{currentUser:d}=L(),{toast:c}=w(),[h,y]=s.useState(""),[a,b]=s.useState(""),[l,v]=s.useState(""),[n,x]=s.useState(!1),[j,p]=s.useState(!0);s.useEffect(()=>{if(!d||!i)return;(async()=>{p(!0);const{data:o,error:m}=await D.from("listings").select("title").eq("id",i).single();if(m||!o){c({title:"İlan Bulunamadı",description:"Şikayet edilecek ilan bulunamadı.",variant:"destructive"}),r(-1);return}y(o.title),p(!1)})()},[d,i,r]);const k=async t=>{if(t.preventDefault(),!a){c({title:"Şikayet Nedeni Seçilmedi",description:"Lütfen bir şikayet nedeni seçin.",variant:"destructive"});return}if(a==="Diğer"&&!l.trim()){c({title:"Detay Gerekli",description:"Lütfen 'Diğer' seçeneği için şikayet detayını belirtin.",variant:"destructive"});return}x(!0);const o={reporter_id:d.id,listing_id:i,reason:a,details:l.trim()},m=await E(o);x(!1),m&&r(`/ilan/${i}`)};return j?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"})}):e.jsxs(F.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"max-w-lg mx-auto px-4 py-12",children:[e.jsxs("div",{className:"flex items-center mb-8",children:[e.jsx(u,{variant:"ghost",size:"icon",onClick:()=>r(-1),className:"mr-4 text-muted-foreground hover:text-foreground",disabled:n,children:e.jsx(G,{className:"w-6 h-6"})}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(I,{className:"w-7 h-7 mr-3 text-destructive"}),e.jsxs("h1",{className:"text-2xl font-bold text-gradient truncate",children:["İlanı Şikayet Et: ",h]})]})]}),e.jsxs("form",{onSubmit:k,className:"space-y-6 p-6 glass-effect rounded-2xl",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Bu ilanın BenAlsam politikalarına aykırı olduğunu düşünüyorsanız, lütfen aşağıdaki formu doldurun."}),e.jsxs("fieldset",{disabled:n,children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(g,{htmlFor:"reason",className:"font-medium",children:"Şikayet Nedeni *"}),e.jsxs(T,{value:a,onValueChange:b,children:[e.jsx(B,{id:"reason",className:"w-full bg-input border-border",children:e.jsx(A,{placeholder:"Bir neden seçin..."})}),e.jsx(z,{className:"dropdown-content",children:P.map(t=>e.jsx(C,{value:t,children:t},t))})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(g,{htmlFor:"details",className:"font-medium",children:"Detaylar (İsteğe Bağlı)"}),e.jsx(R,{id:"details",placeholder:"Şikayetinizle ilgili ek bilgi verin...",value:l,onChange:t=>v(t.target.value),className:"min-h-[120px] bg-input border-border"})]})]}),e.jsxs("div",{className:"flex gap-4 pt-3",children:[e.jsx(u,{type:"button",variant:"outline",onClick:()=>r(-1),disabled:n,className:"flex-1 border-muted-foreground/50 text-muted-foreground hover:bg-muted-foreground/10",children:"İptal"}),e.jsxs(u,{type:"submit",disabled:n||!a||a==="Diğer"&&!l.trim(),className:"flex-1 btn-primary text-primary-foreground",children:[n?e.jsx(f,{className:"w-4 h-4 mr-2 animate-pulse"}):e.jsx(f,{className:"w-4 h-4 mr-2"}),"Şikayeti Gönder"]})]})]})]})};export{U as default};
