import{j as e}from"./query-tMv1bFhv.js";import{u as b,r as o}from"./router-Bq68dJ36.js";import{B as d,d as N,t as c}from"./auth-Dm-7ngQy.js";import{m as p,I as k,ax as w,a2 as E,L as f,av as g,A as I,P as z}from"./ui-YP8xOIYG.js";import{$ as P,aC as _}from"./listings-BkJHjkUV.js";import"./vendor-Bs7gn1Hv.js";import"./images-C3EucWOq.js";import"./supabase-D6FkHI3a.js";const B=({item:t,onEdit:r,onDelete:l})=>e.jsxs(p.div,{layout:!0,initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},transition:{duration:.3},className:"glass-effect rounded-xl p-4 flex flex-col justify-between card-hover",children:[e.jsxs("div",{children:[e.jsx("div",{className:"w-full h-40 bg-muted rounded-lg flex items-center justify-center mb-3 overflow-hidden",children:t.main_image_url?e.jsx("img",{src:t.main_image_url,alt:t.name,className:"w-full h-full object-cover"}):t.image_url?e.jsx("img",{src:t.image_url,alt:t.name,className:"w-full h-full object-cover"}):e.jsx(k,{className:"w-16 h-16 text-muted-foreground"})}),e.jsx("h3",{className:"text-lg font-semibold text-foreground mb-1 truncate",children:t.name}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2 truncate",children:t.category}),e.jsx("p",{className:"text-xs text-muted-foreground line-clamp-2 h-8 mb-3",children:t.description})]}),e.jsxs("div",{className:"flex gap-2 mt-auto",children:[e.jsxs(d,{variant:"outline",size:"sm",onClick:()=>r(t),className:"flex-1 border-primary/50 text-primary hover:bg-primary/10",children:[e.jsx(w,{className:"w-3 h-3 mr-1.5"})," Düzenle"]}),e.jsxs(d,{variant:"outline",size:"sm",onClick:()=>l(t.id),className:"flex-1 border-destructive/50 text-destructive hover:bg-destructive/10",children:[e.jsx(E,{className:"w-3 h-3 mr-1.5"})," Sil"]})]})]}),M=()=>{const t=b(),{currentUser:r,loadingAuth:l}=N(),[a,x]=o.useState([]),[i,h]=o.useState(!1);o.useEffect(()=>{if(r?.id){h(!0);const n=new Promise((s,u)=>setTimeout(()=>u(new Error("Inventory fetch timeout")),1e4));Promise.race([P(r.id),n]).then(s=>{x(s||[])}).catch(s=>{console.error("Error fetching inventory:",s),s.message.includes("timeout")?c({title:"Zaman Aşımı",description:"Envanter yüklenirken zaman aşımı oluştu. Lütfen tekrar deneyin.",variant:"destructive"}):c({title:"Hata",description:"Envanter yüklenirken bir sorun oluştu.",variant:"destructive"})}).finally(()=>{h(!1)})}},[r?.id]);const m=o.useMemo(()=>l||r&&i&&a.length===0,[l,r,i,a.length]),y=o.useMemo(()=>!m&&!i&&a.length===0&&!!r,[m,i,a.length,r]);if(m)return e.jsxs("div",{className:"min-h-[calc(100vh-80px)] flex flex-col items-center justify-center bg-background p-4 text-center",children:[e.jsx(f,{className:"w-16 h-16 animate-spin text-primary mb-6"}),e.jsx("h2",{className:"text-2xl font-semibold text-foreground mb-3",children:l?"Kimlik doğrulanıyor...":"Envanter yükleniyor..."}),e.jsx("p",{className:"text-muted-foreground",children:"Lütfen bekleyin."})]});const v=async n=>{try{await _(r.id,n)?(x(u=>u.filter(j=>j.id!==n)),c({title:"Başarılı",description:"Ürün başarıyla silindi."})):c({title:"Silme Başarısız",description:"Ürün silinirken bir hata oluştu.",variant:"destructive"})}catch(s){console.error("Error deleting inventory item:",s),c({title:"Hata",description:"Ürün silinirken bir sorun oluştu.",variant:"destructive"})}};return e.jsxs(p.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},className:"max-w-6xl mx-auto px-4 py-8",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center mb-8",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-gradient mb-4 md:mb-0",children:"Envanterim"}),e.jsxs(d,{onClick:()=>t("/envanter/yeni"),className:"btn-primary text-primary-foreground",children:[e.jsx(g,{className:"w-5 h-5 mr-2"})," Yeni Ürün Ekle"]})]}),e.jsx("p",{className:"text-muted-foreground mb-8 text-center md:text-left",children:"Burada sahip olduğunuz ve alım ilanlarına teklif olarak sunabileceğiniz ürünleri yönetebilirsiniz. Bu ürünler herkese açık listelenmez."}),r&&i&&a.length>0&&!m&&e.jsxs("div",{className:"text-center py-10",children:[e.jsx(f,{className:"w-8 h-8 text-primary mx-auto mb-3 animate-spin"}),e.jsx("p",{className:"text-muted-foreground",children:"Envanter güncelleniyor..."})]}),!i&&a.length>0&&e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:e.jsx(I,{children:a.map(n=>e.jsx(B,{item:n,onEdit:s=>t(`/envanter/duzenle/${s.id}`),onDelete:v},n.id))})}),y&&e.jsxs("div",{className:"text-center py-20 glass-effect rounded-2xl",children:[e.jsx(z,{className:"w-20 h-20 text-primary mx-auto mb-6"}),e.jsx("h2",{className:"text-2xl font-semibold text-foreground mb-3",children:"Envanterin boş görünüyor."}),e.jsx("p",{className:"text-muted-foreground mb-8 max-w-md mx-auto",children:"Tekliflerde kullanmak üzere sahip olduğun ürünleri buraya ekleyebilirsin."}),e.jsxs(d,{onClick:()=>t("/envanter/yeni"),className:"btn-primary text-primary-foreground px-8 py-3 text-lg",children:[e.jsx(g,{className:"w-5 h-5 mr-2"})," İlk Ürününü Ekle"]})]})]})};export{M as default};
