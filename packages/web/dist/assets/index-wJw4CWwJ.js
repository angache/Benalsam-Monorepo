import{j as e}from"./query-tMv1bFhv.js";import{r as m}from"./router-Bq68dJ36.js";import{B as Q,d as Z,t as q}from"./auth-Dm-7ngQy.js";import{Q as c,U as d,B as A,bK as f,ah as N,ai as b,_ as J,a7 as W,ag as X,bL as ee,bM as se,bN as ae,bO as te}from"./listings-BkJHjkUV.js";import{a4 as _,aT as re,aU as le,Z as k,aQ as w,b as ie,k as g,T as y,g as ne,aR as U,S as C,t as ce,ag as z,an as de,aS as D,af as oe,ah as me,m as P}from"./ui-YP8xOIYG.js";import{P as R,T as xe,a as ue,b as p,c as j}from"./premium-UG-oUUlr.js";import"./vendor-Bs7gn1Hv.js";import"./images-C3EucWOq.js";import"./supabase-D6FkHI3a.js";const ge=()=>e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(_,{className:"w-8 h-8 text-yellow-400"}),e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-yellow-400 to-orange-500 bg-clip-text text-transparent",children:"Premium Dashboard"})]}),e.jsx("p",{className:"text-muted-foreground",children:"Premium özelliklerinizi ve performansınızı takip edin"})]}),he=({userPlan:s})=>e.jsx(c,{className:"mb-8 bg-gradient-to-r from-primary/5 to-secondary/5 border-primary/20",children:e.jsx(d,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-gradient-to-r from-yellow-400 to-orange-500 rounded-full",children:e.jsx(_,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold",children:s?.plan_name||"Premium Plan"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Aktif üyelik • Sonraki ödeme: 15 Şubat 2024"})]})]}),e.jsx(A,{className:"bg-gradient-to-r from-green-400 to-green-500 text-white px-3 py-1",children:"Aktif"})]})})}),v=({icon:s,title:r,value:l,subtitle:a,trend:t,trendValue:n,color:i="text-primary"})=>e.jsx(c,{className:"hover:shadow-lg transition-shadow",children:e.jsxs(d,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:r}),e.jsx("p",{className:"text-2xl font-bold",children:l}),a&&e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:a})]}),e.jsx("div",{className:`p-3 rounded-full bg-primary/10 ${i}`,children:e.jsx(s,{className:"w-6 h-6"})})]}),t&&e.jsxs("div",{className:"flex items-center mt-4 text-sm",children:[t==="up"?e.jsx(re,{className:"w-4 h-4 text-green-500 mr-1"}):e.jsx(le,{className:"w-4 h-4 text-red-500 mr-1"}),e.jsxs("span",{className:t==="up"?"text-green-500":"text-red-500",children:[n,"%"]}),e.jsx("span",{className:"text-muted-foreground ml-1",children:"geçen aya göre"})]})]})}),fe=({stats:s,activities:r,performanceMetrics:l})=>{const a={offers:f(s?.total_offers||0,Math.max(0,(s?.total_offers||0)-5)),accepted:f(s?.accepted_offers||0,Math.max(0,(s?.accepted_offers||0)-2)),views:f(s?.total_views||0,Math.max(0,(s?.total_views||0)-150)),response:f(l?.responseRate||0,Math.max(0,(l?.responseRate||0)-5))},t=i=>{switch(i){case"offer_accepted":return w;case"offer_featured":return C;case"message_sent":case"message_received":return g;default:return k}},n=i=>{switch(i){case"offer_accepted":return"bg-green-100 text-green-600";case"offer_featured":return"bg-yellow-100 text-yellow-600";case"message_sent":case"message_received":return"bg-blue-100 text-blue-600";case"offer_rejected":return"bg-red-100 text-red-600";default:return"bg-gray-100 text-gray-600"}};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(v,{icon:k,title:"Toplam Teklif",value:s?.total_offers||0,subtitle:"Bu ay gönderilen",trend:a.offers.trend,trendValue:a.offers.value,color:"text-blue-500"}),e.jsx(v,{icon:w,title:"Kabul Edilen",value:s?.accepted_offers||0,subtitle:`%${l?.successRate||0} başarı oranı`,trend:a.accepted.trend,trendValue:a.accepted.value,color:"text-green-500"}),e.jsx(v,{icon:ie,title:"Toplam Görüntülenme",value:(s?.total_views||0).toLocaleString(),subtitle:"Tüm teklifler",trend:a.views.trend,trendValue:a.views.value,color:"text-purple-500"}),e.jsx(v,{icon:g,title:"Yanıt Oranı",value:`%${l?.responseRate||0}`,subtitle:`Ort. ${s?.avg_response_time_hours||0}h yanıt süresi`,trend:a.response.trend,trendValue:a.response.value,color:"text-orange-500"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx(c,{children:e.jsx(d,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 rounded-full bg-indigo-100",children:e.jsx(y,{className:"w-6 h-6 text-indigo-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Ortalama Görüntülenme"}),e.jsx("p",{className:"text-2xl font-bold",children:l?.viewsPerOffer||0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"teklif başına"})]})]})})}),e.jsx(c,{children:e.jsx(d,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 rounded-full bg-pink-100",children:e.jsx(ne,{className:"w-6 h-6 text-pink-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Ortalama Yanıt Süresi"}),e.jsxs("p",{className:"text-2xl font-bold",children:[s?.avg_response_time_hours||0,"h"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"mesajlara yanıt"})]})]})})}),e.jsx(c,{children:e.jsx(d,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 rounded-full bg-emerald-100",children:e.jsx(g,{className:"w-6 h-6 text-emerald-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Toplam Mesaj"}),e.jsx("p",{className:"text-2xl font-bold",children:(s?.total_messages_sent||0)+(s?.total_messages_received||0)}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[s?.total_messages_sent||0," gönderilen, ",s?.total_messages_received||0," alınan"]})]})]})})})]}),e.jsxs(c,{children:[e.jsx(N,{children:e.jsxs(b,{className:"flex items-center gap-2",children:[e.jsx(U,{className:"w-5 h-5"}),"Son Aktiviteler"]})}),e.jsx(d,{children:e.jsx("div",{className:"space-y-4",children:r.length>0?r.map((i,o)=>{const x=t(i.activity_type);return e.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-lg bg-muted/50",children:[e.jsx("div",{className:`p-2 rounded-full ${n(i.activity_type)}`,children:e.jsx(x,{className:"w-4 h-4"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium",children:i.activity_title}),i.activity_description&&e.jsx("p",{className:"text-xs text-muted-foreground",children:i.activity_description})]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:i.time_ago})]},o)}):e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(U,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"Henüz aktivite bulunmuyor"}),e.jsx("p",{className:"text-sm",children:"İlk teklifinizi göndererek başlayın!"})]})})})]})]})},u=({title:s,current:r,limit:l,icon:a,color:t="bg-primary"})=>{const i=((x,h)=>h===-1?0:Math.min(x/h*100,100))(r,l),o=l===-1;return e.jsx(c,{children:e.jsxs(d,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${t}/10`,children:e.jsx(a,{className:`w-5 h-5 ${t.replace("bg-","text-")}`})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:s}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[r," / ",o?"∞":l]})]})]}),o&&e.jsx(A,{className:"bg-gradient-to-r from-yellow-400 to-orange-500 text-white",children:"Sınırsız"})]}),!o&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{value:i,className:"h-2"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["%",i.toFixed(1)," kullanıldı"]})]})]})})},pe=({userPlan:s,usage:r})=>e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsx(u,{title:"Aylık Teklifler",current:r?.offers_count||0,limit:s?.limits?.offers_per_month||10,icon:k,color:"bg-blue-500"}),e.jsx(u,{title:"Aylık Mesajlar",current:r?.messages_count||0,limit:s?.limits?.messages_per_month||50,icon:g,color:"bg-green-500"}),e.jsx(u,{title:"Öne Çıkan Teklifler",current:r?.featured_offers_count||0,limit:(s?.limits?.featured_offers_per_day||0)*30,icon:C,color:"bg-yellow-500"}),e.jsx(u,{title:"Resim Ekleme",current:s?.limits?.images_per_offer||2,limit:s?.limits?.images_per_offer||2,icon:ce,color:"bg-purple-500"}),e.jsx(u,{title:"Dosya Ekleme",current:s?.limits?.files_per_offer||0,limit:s?.limits?.files_per_offer||0,icon:z,color:"bg-orange-500"}),e.jsx(u,{title:"Aylık İlanlar",current:r?.listings_count||0,limit:s?.limits?.listings_per_month||3,icon:de,color:"bg-red-500"})]}),je=({stats:s,categoryStats:r,performanceMetrics:l})=>{const a=[{label:"Gönderilen Teklifler",value:s?.total_offers||0,percentage:100,color:"bg-blue-500"},{label:"Görüntülenen Teklifler",value:Math.round((s?.total_offers||0)*.85),percentage:85,color:"bg-purple-500"},{label:"Yanıtlanan Teklifler",value:(s?.accepted_offers||0)+(s?.rejected_offers||0),percentage:l?.responseRate||0,color:"bg-orange-500"},{label:"Kabul Edilen Teklifler",value:s?.accepted_offers||0,percentage:l?.successRate||0,color:"bg-green-500"}];return e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(c,{children:[e.jsx(N,{children:e.jsxs(b,{className:"flex items-center gap-2",children:[e.jsx(D,{className:"w-5 h-5"}),"Teklif Performansı"]})}),e.jsx(d,{children:e.jsx("div",{className:"space-y-6",children:a.map((t,n)=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:t.label}),e.jsx("span",{className:"font-semibold",children:t.value})]}),e.jsx("div",{className:"w-full bg-muted rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full ${t.color}`,style:{width:`${t.percentage}%`}})}),e.jsxs("div",{className:"text-xs text-muted-foreground text-right",children:["%",t.percentage]})]},n))})})]}),e.jsxs(c,{children:[e.jsx(N,{children:e.jsxs(b,{className:"flex items-center gap-2",children:[e.jsx(y,{className:"w-5 h-5"}),"Kategori Dağılımı"]})}),e.jsx(d,{children:e.jsx("div",{className:"space-y-4",children:r.length>0?r.slice(0,6).map((t,n)=>{const i=Math.max(...r.map(x=>x.offer_count)),o=i>0?t.offer_count/i*100:0;return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"font-medium",children:t.category}),e.jsxs("div",{className:"text-right",children:[e.jsxs("span",{className:"font-semibold",children:[t.offer_count," teklif"]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["%",t.success_percentage," başarı"]})]})]}),e.jsx(R,{value:o,className:"h-2"})]},n)}):e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(y,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"Henüz kategori verisi bulunmuyor"}),e.jsx("p",{className:"text-sm",children:"Teklifler gönderdikçe veriler burada görünecek"})]})})})]}),e.jsxs(c,{className:"lg:col-span-2",children:[e.jsx(N,{children:e.jsxs(b,{className:"flex items-center gap-2",children:[e.jsx(w,{className:"w-5 h-5"}),"Detaylı Performans Metrikleri"]})}),e.jsxs(d,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"text-center p-4 bg-muted/50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:s?.total_offers||0}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Toplam Teklif"})]}),e.jsxs("div",{className:"text-center p-4 bg-muted/50 rounded-lg",children:[e.jsxs("div",{className:"text-2xl font-bold text-green-600",children:["%",l?.successRate||0]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Başarı Oranı"})]}),e.jsxs("div",{className:"text-center p-4 bg-muted/50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:l?.viewsPerOffer||0}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Ort. Görüntülenme"})]}),e.jsxs("div",{className:"text-center p-4 bg-muted/50 rounded-lg",children:[e.jsxs("div",{className:"text-2xl font-bold text-orange-600",children:[s?.avg_response_time_hours||0,"h"]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Ort. Yanıt Süresi"})]})]}),e.jsxs("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-blue-50 rounded-lg",children:[e.jsx(k,{className:"w-8 h-8 text-blue-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:s?.pending_offers||0}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Bekleyen Teklif"})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-green-50 rounded-lg",children:[e.jsx(w,{className:"w-8 h-8 text-green-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:s?.accepted_offers||0}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Kabul Edilen"})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-red-50 rounded-lg",children:[e.jsx(y,{className:"w-8 h-8 text-red-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:s?.rejected_offers||0}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Reddedilen"})]})]})]})]})]})]})},ve=({userPlan:s,usage:r})=>{const l=[{icon:C,title:"Öne Çıkarma",description:"Tekliflerinizi öne çıkararak daha fazla görünürlük kazanın",status:"active",usage:`${r?.featured_offers_count||0}/${(s?.limits?.featured_offers_per_day||0)*30}`},{icon:oe,title:"AI Teklif Önerileri",description:"Yapay zeka ile optimize edilmiş teklif önerileri alın",status:s?.plan_slug==="corporate"?"active":"locked",usage:"Sınırsız"},{icon:z,title:"Dosya Ekleme",description:"Tekliflerinize dosya ve döküman ekleyin",status:s?.limits?.files_per_offer>0?"active":"locked",usage:`${s?.limits?.files_per_offer||0} dosya`},{icon:me,title:"Kurumsal Rozet",description:"Güvenilir tedarikçi rozeti ile öne çıkın",status:s?.plan_slug==="corporate"?"active":"locked",usage:"Aktif"},{icon:D,title:"Detaylı Raporlar",description:"Gelişmiş analitik ve performans raporları",status:s?.plan_slug==="corporate"?"active":"locked",usage:"Haftalık"},{icon:g,title:"Öncelikli Destek",description:"Premium müşteri desteği ve canlı yardım",status:"active",usage:"7/24"}];return e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:l.map((a,t)=>e.jsx(c,{className:`${a.status==="locked"?"opacity-60":""}`,children:e.jsx(d,{className:"p-6",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:`p-3 rounded-lg ${a.status==="active"?"bg-primary/10 text-primary":"bg-muted text-muted-foreground"}`,children:e.jsx(a.icon,{className:"w-6 h-6"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("h3",{className:"font-semibold",children:a.title}),e.jsx(A,{variant:a.status==="active"?"default":"secondary",children:a.status==="active"?"Aktif":"Kilitli"})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:a.description}),e.jsxs("p",{className:"text-xs font-medium",children:["Kullanım: ",a.usage]})]})]})})},t))})},Ne=({userPlan:s,usage:r,stats:l,activities:a,categoryStats:t,performanceMetrics:n})=>e.jsxs(xe,{defaultValue:"overview",className:"space-y-6",children:[e.jsxs(ue,{className:"grid w-full grid-cols-4",children:[e.jsx(p,{value:"overview",children:"Genel Bakış"}),e.jsx(p,{value:"usage",children:"Kullanım"}),e.jsx(p,{value:"analytics",children:"Analitik"}),e.jsx(p,{value:"features",children:"Özellikler"})]}),e.jsx(j,{value:"overview",className:"space-y-6",children:e.jsx(fe,{stats:l,activities:a,performanceMetrics:n})}),e.jsx(j,{value:"usage",className:"space-y-6",children:e.jsx(pe,{userPlan:s,usage:r})}),e.jsx(j,{value:"analytics",className:"space-y-6",children:e.jsx(je,{stats:l,categoryStats:t,performanceMetrics:n})}),e.jsx(j,{value:"features",className:"space-y-6",children:e.jsx(ve,{userPlan:s,usage:r})})]}),be=()=>e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-primary"})}),ye=()=>e.jsx(P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(_,{className:"w-16 h-16 mx-auto text-yellow-400 mb-4"}),e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Premium Dashboard"}),e.jsx("p",{className:"text-muted-foreground mb-6",children:"Bu özellik sadece Premium üyeler için kullanılabilir."}),e.jsxs(Q,{onClick:()=>window.location.href="/ayarlar/premium",className:"bg-gradient-to-r from-yellow-400 to-orange-500 hover:from-yellow-500 hover:to-orange-600 text-white",children:[e.jsx(_,{className:"w-4 h-4 mr-2"}),"Premium'a Geç"]})]})}),De=()=>{const{currentUser:s}=Z(),[r,l]=m.useState(null),[a,t]=m.useState(null),[n,i]=m.useState(!1),[o,x]=m.useState(!0),[h,$]=m.useState(null),[E,O]=m.useState([]),[B,G]=m.useState([]),[K,M]=m.useState({});m.useEffect(()=>{s&&V()},[s]);const V=async()=>{x(!0);try{const[T,H,Y,S,I,L]=await Promise.all([J(s.id),W(s.id),X(s.id),ee(s.id),se(s.id,8),ae(s.id)]);if(l(T),t(H),i(Y),$(S),O(I),G(L),S){const F=te(S);M(F)}}catch(T){console.error("Error loading dashboard data:",T),q({title:"Veri Yükleme Hatası",description:"Dashboard verileri yüklenirken bir sorun oluştu.",variant:"destructive"})}finally{x(!1)}};return o?e.jsx(be,{}):n?e.jsxs(P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"container mx-auto px-4 py-8",children:[e.jsx(ge,{}),e.jsx(he,{userPlan:r}),e.jsx(Ne,{userPlan:r,usage:a,stats:h,activities:E,categoryStats:B,performanceMetrics:K})]}):e.jsx(ye,{})};export{De as default};
